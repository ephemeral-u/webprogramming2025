<!DOCTYPE html>
<html lang='ru'>
  <head>
    <meta charset="UTF-8">
    <title>lab1</title>
    <style>
      img {
        width: 200px;
        height: 200px;
      }
      figure {
        text-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
        flex-grow:1;
        border: 2px solid brown;
        border-radius: 20px;
        
        
      }
      h2 {
        color: #A0522D;
        text-align:center;
      }
      button {
        color:white;
        background: #A0522D;
        border: 2px solid black;
        border-radius: 20px;
      }
      a {
        color:#A0522D;
        font-size: 20px;
      }
      .container{
        display: flex;
        flex-wrap: wrap; 
      }
      
      .cart-window {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        border: 3px solid black;
        padding: 20px;
        z-index: 1000;
        display: none;
        flex-direction: column;
        align-items: center;
        flex-grow:1;
      }

      .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        z-index: 999;
        display: none;}
        
        
      .fantasy-magic {
        font-family: 'Papyrus', 'Apple Chancery', cursive;
        font-size: 40px;
        color: brown;}
      
      .buy-button {
        width: 100px;
      }
    </style>
  </head>
 <body bgcolor="#E9967A">
   
    <button onclick="openCart('cartWindow')">Корзина</button>
   
   <h2 class='fantasy-magic'>Your Vinyl</h2>
   <div class="container">
     <figure>
     <a>The Neighbourhood</a>
     <p></p>
     <a>Wiped Out!</a>
     <p></p>
     <img src="https://storage.yandexcloud.net/cute/images/1.jpg">
     <p></p>
     <button class='buy-button' onclick="addToCart('The Neighbourhood - Wiped Out!', 5500)">5500</button>
     </figure> 
     <figure>
     <a>Radiohead</a>
     <p></p>
     <a>In Rainbows</a>
     <p></p>
     <img src="https://storage.yandexcloud.net/cute/images/2.jpg">
     <p></p>
     <button class='buy-button' onclick="addToCart('Radiohead - In Rainbows', 6000)">6000</button>
     </figure>
     <figure>
     <a>Lana Del Ray</a>
     <p></p>
     <a>Ultraviolence</a>
     <p></p>
     <img src="https://storage.yandexcloud.net/cute/images/3.jpg">
     <p></p>
     <button class='buy-button' onclick="addToCart('Lana Del Rey - Ultraviolence', 7000)">7000</button>
     </figure>
     <figure>
     <a>Mitski</a>
     <p></p>
     <a>bury me at make out creek</a>
     <p></p>
     <img src="https://storage.yandexcloud.net/cute/images/4.jpeg">
     <p></p>
     <button class='buy-button' onclick="addToCart('Mitski - bury me at make out creek', 6500)">6500</button>
     </figure>
     <figure>
     <a>Fleetwood Mac</a>
     <p></p>
     <a>Rumors</a>
     <p></p>
     <img src="https://storage.yandexcloud.net/cute/images/5.jpg">
     <p></p>
     <button  class='buy-button' onclick="addToCart('Fleetwood Mac - Rumors', 6200)">6200</button>
     </figure>
     <figure>
     <a>Arctic Monkeys</a>
     <p></p>
     <a>Favourite Worst Nightmares</a>
     <p></p>
     <img src="https://storage.yandexcloud.net/cute/images/6.jpg">
     <p></p>
     <button class='buy-button' onclick="addToCart('Arctic Monkeys - Favourite Worst Nightmares', 7000)">7000</button>
     </figure>
   </div>
   
   <div class="overlay" id="overlay"></div>
      
    <div class="cart-window" id="cartWindow">
      <button onclick="closeCart('cartWindow')">X</button>
      <h2>Корзина</h2>
      <div id="cartContent">
      </div>
    </div>
   
      
    <div class="cart-window" id="orderWindow">
      <button onclick="closeCart('orderWindow')">X</button>
      <h2>Форма заказа</h2>
      <input type="text" id="Name" placeholder="Имя"><br>
      <input type="text" id="Name" placeholder="Фамилия"><br>
      <input type="text" id="Name" placeholder="Адрес"><br>
      <input type="text" id="Name" placeholder="Номер телефона"><br>
      <button onclick="alertOrder()">Создать заказ</button>
    </div>
   
   <script>
     function alertOrder() {
       closeCart("orderWindow");
       closeCart("cartWindow");
       alert('Заказ создан!:)')
       
     }
     
     function openCart(id) {
        document.getElementById(id).style.display = 'block';
        document.getElementById('overlay').style.display = 'block';
        showCartItems();
      }

      function closeCart(id) {
        document.getElementById(id).style.display = 'none';
        document.getElementById('overlay').style.display = 'none';
      }
     
     function addToCart(productName, productPrice) {
        let cart = localStorage.getItem('cart');
        if (!cart) {
          cart = [];
        } else {
          cart = JSON.parse(cart);
        }
        const i = cart.findIndex(item => item.name === productName);
        if (i !== -1) {
         cart[i].count += 1;          
       } else {
         cart.push({
          name: productName,
          price: productPrice,
          count: 1
        });         
        }  
        localStorage.setItem('cart', JSON.stringify(cart));
        alert('Пластинка ' + productName + ' добавлена в корзину.')
        }
                  
      function showCartItems() {
        const cartContent = document.getElementById('cartContent'); 
        
        let cart = localStorage.getItem('cart');
        
        if (!cart || JSON.parse(cart).length === 0) {
          cartContent.innerHTML = '<p>Корзина пуста</p>';
          return;
        }
        
        cart = JSON.parse(cart);
        
        let html = '<ul>';
        cart.forEach(item => {
          html += item.name + '<br>';
          html += item.price + '<br>';
          html += '<button onclick="reduceCartItem(\'' + item.name + '\')">-</button></li>';
          html += item.count
          html += '<button onclick="increaseCartItem(\'' + item.name + '\')">+</button></li><br>';
        });
        html += '</ul>';
        html += 'Итоговая сумма:' + getCartTotal() + '<br>';
        html += '<button onclick="openCart(\'orderWindow\')">Оформить заказ (но это pull re)</button></li>';
        cartContent.innerHTML = html; 
      }
     function reduceCartItem(itemName) {
         let cart = localStorage.getItem('cart');
         cart = JSON.parse(cart);
       	 index = cart.findIndex(item => item.name === itemName);
         if (cart[index].count === 1) {
           cart = cart.filter(item => item.name !== itemName)
         } else if (cart[index].count > 1){
           cart[index].count -= 1;
           }
        localStorage.setItem('cart', JSON.stringify(cart));
       	showCartItems();
     	}
     function increaseCartItem(itemName) {
         let cart = localStorage.getItem('cart');
         cart = JSON.parse(cart);
       	 index = cart.findIndex(item => item.name === itemName);
         cart[index].count += 1;
         localStorage.setItem('cart', JSON.stringify(cart));
       	 showCartItems();
        }
     function getCartTotal() {
    	let cart = localStorage.getItem('cart');
    	if (!cart) return 0;
    	cart = JSON.parse(cart);
    	const total = cart.reduce((sum, item) => {
        return sum + (item.price * item.count);
   	 	}, 0);
    	return total;
}
                  
   </script>
 </body>
</html> 